[build-system]
build-backend = "setuptools.build_meta"
requires = [
    # Building with numpy 2.0 is compatible with numpy 1.x, but it
    # is only available on Python 3.9+
    "numpy >= 2.0.0; python_version > '3.8'",
    "oldest-supported-numpy; python_version <= '3.8'",

    "setuptools>=40.8.0",
    "setuptools_scm>=6.2",
    "wheel",
    "qdldl"
]

[project]
name = "osqp"
dynamic = ["version", "dependencies"]
description = "OSQP: The Operator Splitting QP Solver"
readme = "README.rst"
authors = [
    { name = "Bartolomeo Stellato", email = "bartolomeo.stellato@gmail.com" },
    { name = "Goran Banjac" },
]
classifiers = [
    "License :: OSI Approved :: Apache Software License"
]

[project.optional-dependencies]
dev = [
    # Unit tests fail on scipy 1.12.0
    # see https://github.com/scipy/scipy/issues/20027
    # We'll employ this extra when building wheels
    # using cibuildwheel by setting CIBW_TEST_EXTRAS
    "scipy!=1.12.0",
]

[tool.setuptools_scm]
write_to = "src/osqp/_version.py"

[tool.cibuildwheel]
build = "cp3*"
skip = "*-win32 *-manylinux_i686 *-musllinux_*"
test-requires = ["pytest"]
test-command = "pytest -s {project}/src/osqp/tests -k \"not codegen and not mkl\""
